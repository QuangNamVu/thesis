\chapter{Thí nghiệm với mô hình}

\section{Phân tích hiện thực mô hình tham khảo}
\subsection{Xử lý dữ liệu bài toán}
Yêu cầu của bài toán là dự đoán giá của các đồng với nhau. Bài toán có thể chia ra làm 2 loại như sau:
\begin{itemize}
	\item Phân loại giá tăng hoặc giảm trong một khoảng thời gian kế tiếp.
	\item Dự đoán giá của các đồng xác định trong phạm vi liên tục tại thời gian kế tiếp.
\end{itemize}
Các mô hình đã tham khảo thuộc bài toán học có giám sát, dữ liệu được chia thành 3 ph

\subsection{Áp dụng dữ liệu vào mô hình rừng ngẫu nhiên}
 Đề tài có sử dụng thư viện hỗ trợ scikit-learn để xây dựng rừng ngẫu nhiên.
 Rừng ngẫu nhiên có đầu vào là dữ liệu ở dạng bảng với mỗi thuộc tính (mỗi cột) có thể ở dạng loại rời rạc (category) hoặc liên tục (numerical). Khi áp dụng dữ liệu thô, với mỗi quan sát là một dòng thuộc bảng và nhãn là giá lên hoặc xuống, đối với giá trong 1 phút sau ta có thể phân ra 2 loại tăng hoặc giảm. Tuy nhiên với mỗi quan sát trước có thể phụ thuộc vào nhiều quan sát trước đó, việc sử dụng các cây CART chỉ với một giao dịch là không phù hợp,ta có thể thêm các thuộc tính như giá trung bình trong 1 giờ trước đó, trong một ngày trước đó, \dots
 
 \subsection{Áp dụng dữ liệu vào mô hình mạng nơron tích chập}
 Đề tài có sử dụng thư viện hỗ trợ keras trên nền tensorflow một thư viện mã nguồn mở có hỗ trợ khả năng tính toán của các bộ xử lý đồ họa. Trong bước tiền xử lý dữ liệu để đưa vào trong mạng có sử dụng mỗi cửa sổ trượt làm một ảnh một chiều với số kênh là số thuộc tính của mỗi giao dịch, độ dài của mỗi ảnh được định nghĩa trước là số giao dịch liên tục. Nhãn của những ảnh này là xu hướng tăng hoặc giảm của giao dịch cuối cùng với mỗi ảnh.\\
 Khi dữ liệu được đưa vào mạng nơron cần được chuẩn hóa để tránh hiện tượng các nơron không cập nhật được khi hàm kích hoạt có họ ReLU hoặc khó kích hoạt khi các hàm kích hoạt phi tuyến khác như hàm sigmoid hoặc hàm tanh.\\ Các bước \textbf{chuẩn hóa dữ liệu} được mô tả như sau:
 \begin{itemize}
 	\item Các thuộc tính về thời gian đổi về dạng số nguyên theo chuẩn UNIX.Các số này khá lớn nên được chuẩn hóa dạng logarit, sau đó chuẩn hóa theo standard score.
 	%TODO Standard score viết công thức
 	\item Các thuộc tính còn lại như lượng giao dịch, giá mở, giá đóng theo dạng standard score
 \end{itemize}

Dữ liệu được đưa vào mạng nơron tích chập với ý tuởng chính như sau:


\input{figures/pseudocode_rolling_window}
Khi áp dụng standard score, với mỗi thuộc tính có giá trị trung bình về 0 và phương sai về 1. Điều này ảnh hưởng tốt cho mạng nơron tích chập khi hội tụ nhanh và khó bị `kẹt lại' ở những điểm thung lũng hơn.

% \dots
 % TODO dụng dữ liệu thô như hình 1.1
 
 \section{Kết quả}
 Các số liệu kết quả trong phần này được lấy từ các lần thực nghiệm huấn luyện trên google colab, một nền tảng dịch vụ có hỗ trợ phần cứng và thư viện miễn phí, với dữ liệu đầu vào từ  2012-01-01 đến 2018-11-11 và độ chính xác theo bài toán phân loại lên hoặc xuống.
 
  \textbf{Mô hình rừng ngẫu nhiên} Kết quả cho độ chính xác là 53\%. \\
  \textbf{Mô hình mạng nơron tích chập} Kết quả cho độ chính xác là 71\% được tính bằng trung bình của 65 lần kiểm thử cuối. %Kết quả được mô tả như hình sau:\\
  %\includegraphics{figures/} 
 % TODO: get information about google clould resource
 
 